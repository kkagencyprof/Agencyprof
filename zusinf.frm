VERSION 5.00
Object = "{E5A19D51-DD6B-11D4-AB81-BBEAD055682C}#1.0#0"; "Resizer.ocx"
Begin VB.Form zusinf 
   Caption         =   "Zusatzinfos"
   ClientHeight    =   6435
   ClientLeft      =   60
   ClientTop       =   450
   ClientWidth     =   7110
   LinkTopic       =   "Form2"
   ScaleHeight     =   6435
   ScaleWidth      =   7110
   StartUpPosition =   3  'Windows-Standard
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   14
      Left            =   8760
      TabIndex        =   49
      Text            =   "Text2"
      Top             =   5280
      Visible         =   0   'False
      Width           =   4695
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   13
      Left            =   8760
      TabIndex        =   48
      Text            =   "Text2"
      Top             =   4920
      Visible         =   0   'False
      Width           =   4695
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   12
      Left            =   8760
      TabIndex        =   47
      Text            =   "Text2"
      Top             =   4560
      Visible         =   0   'False
      Width           =   4695
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   11
      Left            =   8760
      TabIndex        =   46
      Text            =   "Text2"
      Top             =   4200
      Visible         =   0   'False
      Width           =   4695
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   10
      Left            =   8760
      TabIndex        =   45
      Text            =   "Text2"
      Top             =   3840
      Visible         =   0   'False
      Width           =   4695
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   9
      Left            =   8760
      TabIndex        =   44
      Text            =   "Text2"
      Top             =   3480
      Visible         =   0   'False
      Width           =   4695
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   8
      Left            =   8760
      TabIndex        =   43
      Text            =   "Text2"
      Top             =   3120
      Visible         =   0   'False
      Width           =   4695
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   7
      Left            =   8760
      TabIndex        =   42
      Text            =   "Text2"
      Top             =   2760
      Visible         =   0   'False
      Width           =   4695
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   6
      Left            =   8760
      TabIndex        =   41
      Text            =   "Text2"
      Top             =   2400
      Visible         =   0   'False
      Width           =   4695
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   5
      Left            =   8760
      TabIndex        =   40
      Text            =   "Text2"
      Top             =   2040
      Visible         =   0   'False
      Width           =   4695
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   4
      Left            =   8760
      TabIndex        =   39
      Text            =   "Text2"
      Top             =   1680
      Visible         =   0   'False
      Width           =   4695
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   3
      Left            =   8760
      TabIndex        =   38
      Text            =   "Text2"
      Top             =   1320
      Visible         =   0   'False
      Width           =   4695
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   2
      Left            =   8760
      TabIndex        =   37
      Text            =   "Text2"
      Top             =   960
      Visible         =   0   'False
      Width           =   4695
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   1
      Left            =   8760
      TabIndex        =   36
      Text            =   "Text2"
      Top             =   600
      Visible         =   0   'False
      Width           =   4695
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   0
      Left            =   8760
      TabIndex        =   35
      Text            =   "Text2"
      Top             =   240
      Visible         =   0   'False
      Width           =   4695
   End
   Begin VB.CommandButton Command4 
      BackColor       =   &H00C0C0C0&
      Enabled         =   0   'False
      Height          =   375
      Left            =   840
      MaskColor       =   &H00000000&
      Picture         =   "zusinf.frx":0000
      Style           =   1  'Grafisch
      TabIndex        =   33
      ToolTipText     =   "Speichern"
      Top             =   5880
      Width           =   375
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   14
      Left            =   2400
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertikal
      TabIndex        =   29
      Text            =   "zusinf.frx":0672
      Top             =   5280
      Width           =   4215
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   13
      Left            =   2400
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertikal
      TabIndex        =   27
      Text            =   "zusinf.frx":0678
      Top             =   4920
      Width           =   4215
   End
   Begin VB.CommandButton Command1 
      Height          =   375
      Left            =   360
      Picture         =   "zusinf.frx":067E
      Style           =   1  'Grafisch
      TabIndex        =   26
      ToolTipText     =   "Auf Wiedersehen!"
      Top             =   5880
      Width           =   375
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   12
      Left            =   2400
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertikal
      TabIndex        =   25
      Text            =   "zusinf.frx":08CE
      Top             =   4560
      Width           =   4215
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   11
      Left            =   2400
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertikal
      TabIndex        =   23
      Text            =   "zusinf.frx":08D4
      Top             =   4200
      Width           =   4215
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   10
      Left            =   2400
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertikal
      TabIndex        =   21
      Text            =   "zusinf.frx":08DA
      Top             =   3840
      Width           =   4215
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   9
      Left            =   2400
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertikal
      TabIndex        =   19
      Text            =   "zusinf.frx":08E0
      Top             =   3480
      Width           =   4215
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   8
      Left            =   2400
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertikal
      TabIndex        =   17
      Text            =   "zusinf.frx":08E6
      Top             =   3120
      Width           =   4215
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   7
      Left            =   2400
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertikal
      TabIndex        =   15
      Text            =   "zusinf.frx":08EC
      Top             =   2760
      Width           =   4215
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   6
      Left            =   2400
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertikal
      TabIndex        =   13
      Text            =   "zusinf.frx":08F2
      Top             =   2400
      Width           =   4215
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   5
      Left            =   2400
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertikal
      TabIndex        =   11
      Text            =   "zusinf.frx":08F8
      Top             =   2040
      Width           =   4215
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   4
      Left            =   2400
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertikal
      TabIndex        =   9
      Text            =   "zusinf.frx":08FE
      Top             =   1680
      Width           =   4215
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   3
      Left            =   2400
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertikal
      TabIndex        =   7
      Text            =   "zusinf.frx":0904
      Top             =   1320
      Width           =   4215
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   2
      Left            =   2400
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertikal
      TabIndex        =   5
      Text            =   "zusinf.frx":090A
      Top             =   960
      Width           =   4215
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   1
      Left            =   2400
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertikal
      TabIndex        =   3
      Text            =   "zusinf.frx":0910
      Top             =   600
      Width           =   4215
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   0
      Left            =   2400
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertikal
      TabIndex        =   2
      Text            =   "zusinf.frx":0916
      Top             =   240
      Width           =   4215
   End
   Begin Resizer.axsResizer axsResizer1 
      Left            =   6000
      Top             =   5520
      _ExtentX        =   820
      _ExtentY        =   820
   End
   Begin VB.Label typid 
      Caption         =   "typ"
      Height          =   255
      Left            =   2640
      TabIndex        =   34
      Top             =   5520
      Visible         =   0   'False
      Width           =   1095
   End
   Begin VB.Label kid 
      Caption         =   "kid"
      Height          =   255
      Left            =   1440
      TabIndex        =   32
      Top             =   5520
      Visible         =   0   'False
      Width           =   1095
   End
   Begin VB.Label adrid 
      Caption         =   "adrid"
      Height          =   255
      Left            =   120
      TabIndex        =   31
      Top             =   5520
      Visible         =   0   'False
      Width           =   1215
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Label1"
      Height          =   255
      Index           =   14
      Left            =   480
      TabIndex        =   30
      Top             =   5280
      Width           =   1815
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Label1"
      Height          =   255
      Index           =   13
      Left            =   480
      TabIndex        =   28
      Top             =   4920
      Width           =   1815
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Label1"
      Height          =   255
      Index           =   12
      Left            =   480
      TabIndex        =   24
      Top             =   4560
      Width           =   1815
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Label1"
      Height          =   255
      Index           =   11
      Left            =   480
      TabIndex        =   22
      Top             =   4200
      Width           =   1815
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Label1"
      Height          =   255
      Index           =   10
      Left            =   480
      TabIndex        =   20
      Top             =   3840
      Width           =   1815
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Label1"
      Height          =   255
      Index           =   9
      Left            =   480
      TabIndex        =   18
      Top             =   3480
      Width           =   1815
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Label1"
      Height          =   255
      Index           =   8
      Left            =   480
      TabIndex        =   16
      Top             =   3120
      Width           =   1815
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Label1"
      Height          =   255
      Index           =   7
      Left            =   480
      TabIndex        =   14
      Top             =   2760
      Width           =   1815
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Label1"
      Height          =   255
      Index           =   6
      Left            =   480
      TabIndex        =   12
      Top             =   2400
      Width           =   1815
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Label1"
      Height          =   255
      Index           =   5
      Left            =   480
      TabIndex        =   10
      Top             =   2040
      Width           =   1815
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Label1"
      Height          =   255
      Index           =   4
      Left            =   480
      TabIndex        =   8
      Top             =   1680
      Width           =   1815
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Label1"
      Height          =   255
      Index           =   3
      Left            =   480
      TabIndex        =   6
      Top             =   1320
      Width           =   1815
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Label1"
      Height          =   255
      Index           =   2
      Left            =   480
      TabIndex        =   4
      Top             =   960
      Width           =   1815
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Label1"
      Height          =   255
      Index           =   1
      Left            =   480
      TabIndex        =   1
      Top             =   600
      Width           =   1815
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Label1"
      Height          =   255
      Index           =   0
      Left            =   480
      TabIndex        =   0
      Top             =   240
      Width           =   1815
   End
   Begin VB.Shape Shape1 
      BackColor       =   &H00C0C0C0&
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   5535
      Left            =   120
      Shape           =   4  'Gerundetes Rechteck
      Top             =   120
      Width           =   6855
   End
   Begin VB.Shape Shape2 
      BackColor       =   &H00C0C0C0&
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   615
      Left            =   120
      Shape           =   4  'Gerundetes Rechteck
      Top             =   5760
      Width           =   6855
   End
End
Attribute VB_Name = "zusinf"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub Command1_Click()
Unload Me
End Sub

Private Sub Command4_Click()
Dim i%, c$, t$, wht, p%, kidi$

wht = RGB(255, 255, 255)
Call form1.dbg2f("save", "zusinf", "Command4_Click")
For i% = 0 To 14
  If Not Label1(i%).Visible Then Exit For
  If Text1(i%).BackColor <> wht Then
    t$ = strrepl(Text1(i%).text, "'", "´")
    c$ = strrepl(Text2(i%).text, "$$$", t$)
    If t$ = "" Then
      t$ = c$
      p% = InStr(t$, "where id=")
      If p% > 0 Then
        c$ = "delete from auftritthigru " + Mid(t$, p%)
      Else
        c$ = ""
      End If
    End If
    Text1(i%).BackColor = wht
    If c$ <> "" Then
Call form1.dbg2f("i=" + trm(i%) + ", t=" + t$, "zusinf", "Command4_Click")
      Call form1.sqlqry(c$)
    End If
  End If
Next i%
If Not form1.isfieldmissing("auftritthigru", "opt_kid") Then
  kidi$ = kid.Caption
  If kidi$ <> "" Then
    c$ = "update auftritthigru set opt_kid='" + kidi$ + "' where auftrittstyp='" + typid.Caption + "' and auftrittsid='" + adrid.Caption + kidi$ + "'"
    Call form1.sqlqry(c$)
  End If
End If
Command4.Enabled = False
Call shwAdrDetail.reshow4
End Sub

Private Sub Form_Load()
Dim i%

axsResizer1.SaveControlPositions
Me.Top = form1.mylasttop(Me.name)
Me.Left = form1.mylastleft(Me.name)
Call form1.formpos(Me)
For i% = 0 To 14
  Label1(i%).Visible = False
  Text1(i%).Visible = False
Next i%
Me.BackColor = form1.cleancolor()
Show
End Sub

Private Sub Form_Resize()
axsResizer1.Resize

End Sub

Private Sub Form_Unload(Cancel As Integer)
Call form1.dbg2f("zusatzinfos schliessen", "zusinf", "Unload")
Call savecheck
Hide
On Error GoTo exzus
Call form1.setmylasttop(Me.name, Me.Top)
Call form1.setmylastleft(Me.name, Me.Left)
exzus:
On Error GoTo 0

End Sub

Private Sub Text1_Change(Index As Integer)
Text1(Index).BackColor = form1.dirtycolor()
Command4.Enabled = True
End Sub

Private Sub savecheck()
Dim i%, wht, antw

wht = RGB(255, 255, 255)
Call form1.dbg2f("savecheck", "zusinf", "savecheck")
For i% = 0 To 14
  If Not Label1(i%).Visible Then Exit For
  If Text1(i%).BackColor <> wht Then
    If form1.immerspeichern() = "ja" Then
      antw = vbYes
    Else
      antw = MsgBox(transe("Sie haben Daten geändert, möchten Sie speichern?"), vbYesNo + vbCritical + vbDefaultButton2, transe("Änderungen speichern?"))
    End If
    If antw = vbYes Then
      Call Command4_Click
    End If
    Exit Sub
  End If
Next i%

End Sub
